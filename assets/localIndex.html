<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h1>Enter a new to register</h1>
<input id="nameField" />
<button onclick="registerDevice()">Register Device</button>


<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>
<script>
    var token = undefined;
    var user = undefined;
    var parts = undefined;
    var socket = io('https://god.stift-klosterneuburg.at/');

    function registerDevice()
    {
        var name = document.getElementById("nameField").value;

        socket.emit('registerOD', {
            identifier: name,
            email: name + '@fhstp.ac.at',
            password: 'pwd',
            isGuest: false,
            deviceAddress: 'deviceAddress',
            deviceOS: 'deviceOS',
            deviceVersion: 'deviceVersion',
            deviceModel: 'deviceModel',
            ipAddress: 'not set',
            language: 1
        });
    }

    socket.on('news', function (data) {

        console.log(data);

        socket.on('registerODResult', function (result)
        {
            console.log("------------ Registered user ------------");
            console.log(result);
            user = result.data.user;
            // socket.emit('getCoaParts');
            // socket.emit('getCoaColors');
            socket.emit('registerTimelineUpdate', {user: user.id, location: 3000});
            // socket.emit('registerLocation', {user: user.id, location: 3000});
            // socket.emit('questionnaireAnswered', user.id);
            // socket.emit('checkAppVersion', {user: user.id, version: '1.0.0'});
            // socket.emit('addUserLogEntry', {user: user.id, logType: 1, location: 301});

            socket.removeAllListeners('registerODResult');
        });

        socket.on('checkAppVersionResult', function(res)
        {
            console.log("------------ checkAppVersion ------------");
            console.log(res);

            socket.removeAllListeners('checkAppVersionResult');
        });

        socket.on('questionnaireAnsweredResult', function(result)
        {
            console.log("------------ questionnaireAnswered ------------");
            console.log(result);

            socket.removeAllListeners('questionnaireAnsweredResult');
        });

        socket.on('getCoaPartsResult', function (result)
        {
            parts = result.data;
            console.log("------------ Get Coa Parts ------------");
            console.log(parts);

            socket.emit('unlockCoaPart', {userId: user.id, coaId: parts[0].id});
        });

        socket.on('unlockCoaPartResult', function (result)
        {
            var userParts = result.data;
            console.log("------------ Unlock Coa Part ------------");
            console.log(userParts);

            socket.emit('getUserCoaParts', {userId: user.id, coaId: parts[0].id});
        });

        socket.on('getUserCoaPartsResult', function(result)
        {
           var userParts = result.data;
           console.log("------------ Get User Coa Parts ------------");
           console.log(userParts);
        });

        socket.on('getCoaColorsResult', function(result)
        {
            var colors = result.data;
            console.log("------------ Get Coa Colors ------------");
            console.log(colors);
            socket.emit('changeUserCoaColors', {userId: user.id, primary: 1, secondary: 3});
        });

        socket.on('changeUserCoaColorsResult', function(result)
        {
            console.log("------------ change user coa colors ------------");
            console.log(result.data);
        });

        socket.on('registerTimelineUpdateResult', function(result)
        {
            console.log("------------ register TimelineUpdate ------------");
            console.log(result);
        });

    });
</script>
</body>
</html>
